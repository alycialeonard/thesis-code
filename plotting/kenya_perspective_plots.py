# Plots for Kenya COP26 perspective piece + follow-up journal piece on spending/electrification over time
# Author: Alycia Leonard, Energy and Power Group, University of Oxford
# Contact: alycia.leonard@eng.ox.ac.uk

import pandas as pd
import matplotlib.pyplot as plt
from matplotlib.ticker import MultipleLocator
import numpy as np

# Electrification rate over time. All data WorldBank.

my_dpi = 120

dates = [1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006,
         2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019]

elec_rate = [10.9, 3.473436832, 5.427343369, 7.378530502, 9.326317787, 14.5, 13.20889187, 15.14182186, 17.0676403,
             18.98517036, 16, 22.79066277, 24.67642593, 26.55305481, 28.42663383, 30.30339813, 23, 19.2, 36.01516342,
             37.96532059, 39.93959045, 36, 41.6, 53.1, 56.09143066, 61.43641663, 69.7]

plt.figure(figsize=(1264/my_dpi, 520/my_dpi), dpi=my_dpi)
plt.plot(dates, elec_rate, '-ok', color='turquoise', markersize=8, linewidth=2, markerfacecolor='turquoise',
         markeredgecolor='white', markeredgewidth=1, zorder=3)
ax = plt.gca()
plt.ylim(0, 100)
plt.xlim(1992, 2020)
plt.xticks(np.arange(min(dates), max(dates)+2, 2.0))
ax.set_xticks(np.arange(min(dates), max(dates)+2, 1), minor=True)
plt.yticks(np.arange(0, 110, 10))
plt.grid(axis='y')
plt.grid(which='both', axis='x')#, linestyle='--')
plt.axes().xaxis.set_minor_locator(MultipleLocator(1))
plt.xlabel('Year')
plt.ylabel('Access to electricity (% of population)')
xcoords = [1997, 2004, 2008, 2015, 2018] # 2012,
for xc in xcoords:
    plt.axvline(x=xc, linewidth=2, color='orange', zorder=2)
props = {'ha': 'center', 'va': 'center', 'bbox': {'edgecolor': 'orange', 'linewidth': 2, 'fc': '1', 'pad': 5}}
props_2 = {'ha': 'center', 'va': 'center', 'bbox': {'color': 'purple', 'alpha': 0, 'pad': 5}}
ax.text(1997, 62, 'Electric Power Act', props, rotation='vertical')
ax.text(2004, 62, ' Sessional Paper on Energy', props, rotation='vertical')
ax.text(2008, 62, 'Vision 2030 Starts', props, rotation='vertical')
ax.text(2015, 70, 'LMCP Starts', props, rotation='vertical')
ax.text(2018, 79, 'KNES', props, rotation='vertical')
ax.text(2009, 95, 'MTP 1', props_2)
ax.text(2014, 95, 'MTP 2', props_2)
ax.text(2019, 95, 'MTP 3', props_2)
plt.axvspan(xmin=2008, xmax=2012, color='purple', alpha=0.3, zorder=2)
plt.axvspan(xmin=2013, xmax=2017, color='purple', alpha=0.3, zorder=2)
plt.axvspan(xmin=2018, xmax=2020, color='purple', alpha=0.3, zorder=2)
plt.show()


# Costs of fuel, SHS, and grid over time

month = [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43]

shs_running = [0,4499,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1200,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
lmcp_upfront_running = [0,15000,0,0,0,0,0,21720,80,128,224,256,288,288,304,320,320,336,336,352,368,368,368,384,384,384,400,400,400,400,416,416,432,432,432,432,448,448,448,448,448,464,464,464]
lmcp_monthly_running = [0,416,416,416,416,416,416,22136,496,544,640,672,704,704,720,736,736,752,752,768,784,784,784,800,800,800,816,816,816,816,832,832,848,848,848,848,864,448,448,448,448,464,464,464]
fuel_running = [0,2224,624,624,624,624,624,624,624,624,624,624,624,624,624,624,624,624,624,624,624,624,624,624,624,624,624,624,624,624,624,624,624,624,624,624,624,624,624,624,624,624,624,624]

shs_cumulative = [0,4499,5999,7499,8999,10499,11999,13499,14999,16499,17999,19499,20999,22499,23699,23699,23699,23699,23699,23699,23699,23699,23699,23699,23699,23699,23699,23699,23699,23699,23699,23699,23699,23699,23699,23699,23699,23699,23699,23699,23699,23699,23699,23699]
lmcp_upfront_cumulative = [0,15000,15000,15000,15000,15000,15000,36720,36800,36928,37152,37408,37696,37984,38288,38608,38928,39264,39600,39952,40320,40688,41056,41440,41824,42208,42608,43008,43408,43808,44224,44640,45072,45504,45936,46368,46816,47264,47712,48160,48608,49072,49536,50000]
lmcp_monthly_cumulative = [0,416,832,1248,1664,2080,2496,24632,25128,25672,26312,26984,27688,28392,29112,29848,30584,31336,32088,32856,33640,34424,35208,36008,36808,37608,38424,39240,40056,40872,41704,42536,43384,44232,45080,45928,46792,47240,47688,48136,48584,49048,49512,49976]
fuel_cumulative = [0,2224,2848,3472,4096,4720,5344,5968,6592,7216,7840,8464,9088,9712,10336,10960,11584,12208,12832,13456,14080,14704,15328,15952,16576,17200,17824,18448,19072,19696,20320,20944,21568,22192,22816,23440,24064,24688,25312,25936,26560,27184,27808,28432]

month_long = [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127]
shs_cumulative_long = [0,4519,6039,7559,9079,10599,12119,13639,15159,16679,18199,19719,21239,22759,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975]
lmcp_upfront_cumulative_long = [0,15000,15000,15000,15000,15000,15000,36720,36800,36928,37152,37408,37696,37984,38288,38608,38928,39264,39600,39952,40320,40688,41056,41440,41824,42208,42608,43008,43408,43808,44224,44640,45072,45504,45936,46368,46816,47264,47712,48160,48608,49072,49536,50000,50464,50928,51408,51888,52368,52848,53328,53808,54288,54784,55280,55776,56272,56768,57280,57808,58336,58864,59392,59936,60480,61024,61584,62160,62736,63312,63888,64464,65056,65648,66224,66800,67392,67984,68592,69200,69808,70416,71040,71664,72272,72880,73504,74128,74752,75392,76032,76672,77312,77952,78608,79248,79920,80576,81216,81872,82512,83168,83824,84496,85152,85824,86496,87168,87840,88528,89200,89872,90544,91232,91912,92568,93240,93928,94600,95288,95976,96664,97336,98024,98712,99400,100072,100744]
lmcp_monthly_cumulative_long = [0, 416,832,1248,1664,2080,2496,24632,25128,25672,26312,26984,27688,28392,29112,29848,30584,31336,32088,32856,33640,34424,35208,36008,36808,37608,38424,39240,40056,40872,41704,42536,43384,44232,45080,45928,46792,47240,47688,48136,48584,49048,49512,49976,50440,50904,51384,51864,52344,52824,53304,53784,54264,54760,55256,55752,56248,56744,57256,57784,58312,58840,59368,59912,60456,61000,61560,62136,62712,63288,63864,64440,65032,65624,66200,66776,67368,67960,68568,69176,69784,70392,71016,71640,72248,72856,73480,74104,74728,75368,76008,76648,77288,77928,78584,79224,79896,80552,81192,81848,82488,83144,83800,84472,85128,85800,86472,87144,87816,88504,89176,89848,90520,91208,91888,92544,93216,93904,94576,95264,95952,95952,95952,95952,95952,95952,95952,95952]
fuel_cumulative_long = [0,2224,2848,3472,4096,4720,5344,5968,6592,7216,7840,8464,9088,9712,10336,10960,11584,12208,12832,13456,14080,14704,15328,15952,16576,17200,17824,18448,19072,19696,20320,20944,21568,22192,22816,23440,24064,24688,25312,25936,26560,27184,27808,28432,29056,29680,30304,30928,31552,32176,32800,33424,34048,34672,35296,35920,36544,37168,37792,38416,39040,39664,40288,40912,41536,42160,42784,43408,44032,44656,45280,45904,46528,47152,47776,48400,49024,49648,50272,50896,51520,52144,52768,53392,54016,54640,55264,55888,56512,57136,57760,58384,59008,59632,60256,60880,61504,62128,62752,63376,64000,64624,65248,65872,66496,67120,67744,68368,68992,69616,70240,70864,71488,72112,72736,73360,73984,74608,75232,75856,76480,77104,77728,78352,78976,79600,80224,80848]

month_48 = [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48]
shs_cumulative_48 = [0,4519,6039,7559,9079,10599,12119,13639,15159,16679,18199,19719,21239,22759,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975,23975]
lmcp_upfront_cumulative_48 = [0,15000,15000,15000,15000,15000,15000,36720,36800,36928,37152,37408,37696,37984,38288,38608,38928,39264,39600,39952,40320,40688,41056,41440,41824,42208,42608,43008,43408,43808,44224,44640,45072,45504,45936,46368,46816,47264,47712,48160,48608,49072,49536,50000,50464,50928,51408,51888,52368]
lmcp_monthly_cumulative_48 = [0, 416,832,1248,1664,2080,2496,24632,25128,25672,26312,26984,27688,28392,29112,29848,30584,31336,32088,32856,33640,34424,35208,36008,36808,37608,38424,39240,40056,40872,41704,42536,43384,44232,45080,45928,46792,47240,47688,48136,48584,49048,49512,49976,50440,50904,51384,51864,52344]
fuel_cumulative_48 = [0,2224,2848,3472,4096,4720,5344,5968,6592,7216,7840,8464,9088,9712,10336,10960,11584,12208,12832,13456,14080,14704,15328,15952,16576,17200,17824,18448,19072,19696,20320,20944,21568,22192,22816,23440,24064,24688,25312,25936,26560,27184,27808,28432,29056,29680,30304,30928,31552]


# plt.plot(month, shs_running, '-ok', color='turquoise', markersize=10, linewidth=2, markerfacecolor='turquoise',
#          markeredgecolor='white', markeredgewidth=1, zorder=3)
# plt.plot(month, lmcp_upfront_running, '-ok', color='purple', markersize=10, linewidth=2, markerfacecolor='purple',
#          markeredgecolor='white', markeredgewidth=1, zorder=3)
# plt.plot(month, lmcp_monthly_running, '-ok', color='pink', markersize=10, linewidth=2, markerfacecolor='pink',
#          markeredgecolor='white', markeredgewidth=1, zorder=3)
# plt.plot(month, fuel_running, '-ok', color='orange', markersize=10, linewidth=2, markerfacecolor='orange',
#          markeredgecolor='white', markeredgewidth=1, zorder=3)

plt.plot(month_48, shs_cumulative_48, '-ok', color='turquoise', markersize=8, linewidth=2, markerfacecolor='turquoise',
          markeredgecolor='white', markeredgewidth=1, zorder=3, label='Solar Home System')
plt.plot(month_48, lmcp_upfront_cumulative_48, '-ok', color='purple', markersize=8, linewidth=2, markerfacecolor='purple',
          markeredgecolor='white', markeredgewidth=1, zorder=3, label='Grid (LMCP with up-front deposit)')
plt.plot(month_48, lmcp_monthly_cumulative_48, '-ok', color='pink', markersize=8, linewidth=2, markerfacecolor='pink',
          markeredgecolor='white', markeredgewidth=1, zorder=3, label='Grid (LMCP with monthly payback)')
plt.plot(month_48, fuel_cumulative_48, '-ok', color='orange', markersize=8, linewidth=2, markerfacecolor='orange',
          markeredgecolor='white', markeredgewidth=1, zorder=3, label='Fuel and Charging Services')

plt.ylim(0, 55000)
plt.xlim(0, 48)
plt.xticks(np.arange(min(month_48), max(month_48)+1, 2.0))
plt.yticks(np.arange(0, 55000, 5000))
plt.grid(axis='y')
plt.grid(axis='x')
#plt.grid(which='minor', axis='x')#, linestyle='--')
#plt.axes().xaxis.set_minor_locator(MultipleLocator(1))
plt.xlabel('Month following initiation of energy service use')
plt.ylabel('Money spent to date (KES)')
plt.legend()
xcoords = [12, 24, 36]
for xc in xcoords:
    plt.axvline(x=xc, linewidth=2, color='darkblue', zorder=2)
#plt.axvspan(xmin=2008, xmax=2012, color='purple', alpha=0.3, zorder=2)
#plt.axvspan(xmin=2013, xmax=2017, color='purple', alpha=0.3, zorder=2)
#plt.axvspan(xmin=2018, xmax=2019, color='purple', alpha=0.3, zorder=2)
plt.show()

